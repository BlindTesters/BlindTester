const crypto = require('crypto');

describe('blindtester-crypto.pbkdf2Sync', () => {
    test('crypto.pbkdf2Sync("seg-2023","salt0",1000.0,64.0,"sha512") should returns {"type":"Buffer","data":[101.0,161.0,8.0,172.0,123.0,228.0,177.0,148.0,250.0,162.0,40.0,83.0,37.0,141.0,13.0,120.0,181.0,43.0,56.0,18.0,240.0,227.0,86.0,245.0,122.0,173.0,68.0,126.0,156.0,39.0,54.0,165.0,29.0,82.0,14.0,183.0,140.0,164.0,131.0,239.0,6.0,242.0,134.0,100.0,164.0,19.0,195.0,5.0,63.0,24.0,148.0,129.0,28.0,37.0,129.0,221.0,194.0,123.0,252.0,126.0,92.0,49.0,208.0,170.0]}', () => {
        const crypto = require('crypto');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');

        expect(crypto.pbkdf2Sync("seg-2023","salt0",1000.0,64.0,"sha512").toJSON()).toMatchObject({"type":"Buffer","data":[101.0,161.0,8.0,172.0,123.0,228.0,177.0,148.0,250.0,162.0,40.0,83.0,37.0,141.0,13.0,120.0,181.0,43.0,56.0,18.0,240.0,227.0,86.0,245.0,122.0,173.0,68.0,126.0,156.0,39.0,54.0,165.0,29.0,82.0,14.0,183.0,140.0,164.0,131.0,239.0,6.0,242.0,134.0,100.0,164.0,19.0,195.0,5.0,63.0,24.0,148.0,129.0,28.0,37.0,129.0,221.0,194.0,123.0,252.0,126.0,92.0,49.0,208.0,170.0]});
    });
    test('crypto.pbkdf2Sync("seg-2023","salt32",1000.0,64.0,"sha512") should returns {"type":"Buffer","data":[151.0,73.0,229.0,161.0,25.0,124.0,139.0,113.0,162.0,175.0,185.0,6.0,117.0,95.0,168.0,136.0,249.0,93.0,113.0,249.0,52.0,172.0,204.0,206.0,112.0,46.0,143.0,120.0,113.0,169.0,149.0,53.0,71.0,64.0,73.0,25.0,244.0,189.0,69.0,248.0,253.0,9.0,82.0,157.0,135.0,75.0,7.0,210.0,75.0,159.0,69.0,215.0,159.0,111.0,178.0,43.0,217.0,43.0,1.0,221.0,119.0,159.0,67.0,171.0]}', () => {
        const crypto = require('crypto');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');
        hash = crypto.pbkdf2Sync('seg-2023', 'salt' + i, 1000, 64, 'sha512');

        expect(crypto.pbkdf2Sync("seg-2023","salt32",1000.0,64.0,"sha512").toJSON()).toMatchObject({"type":"Buffer","data":[151.0,73.0,229.0,161.0,25.0,124.0,139.0,113.0,162.0,175.0,185.0,6.0,117.0,95.0,168.0,136.0,249.0,93.0,113.0,249.0,52.0,172.0,204.0,206.0,112.0,46.0,143.0,120.0,113.0,169.0,149.0,53.0,71.0,64.0,73.0,25.0,244.0,189.0,69.0,248.0,253.0,9.0,82.0,157.0,135.0,75.0,7.0,210.0,75.0,159.0,69.0,215.0,159.0,111.0,178.0,43.0,217.0,43.0,1.0,221.0,119.0,159.0,67.0,171.0]});
    });
});